<!--
  ~ Copyright Â© 2020 xx network SEZC                                           ///
  ~                                                                            ///
  ~ Use of this source code is governed by a license that can be found in the  ///
  ~ LICENSE file                                                               ///
  -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Sender</title>

	<link rel="stylesheet" type="text/css" href="../styles.css">
	<link rel="shortcut icon" type="image/x-icon" href="sender-favicon.ico" />
	<script type="text/javascript" src="xxdk.js"></script>
	<script type="text/javascript" src="../wasm_exec.js"></script>
	<script>
        // Use the encoder to convert a string to Uint8Array using enc.encode()

        const go = new Go();
        WebAssembly.instantiateStreaming(fetch("../xxdk.wasm"), go.importObject).then((result) => {
            go.run(result.instance);

            LogLevel(0);

            const recipientContactFile = '<xxc(2)Q2uq69ry88AeNFKcnpOkCjuCtkYIdv/fgC3F4z6eNUMDrgZ7Ugdw/BAr6bG0KyMpEOL6fulH331JBFOD69e7iZLxkBr3BvZyfyTXL9QtQwpzaDnmPXjyRR5cjAQ6gfk5XQzsrw45Q8qsrKewwZsqGhac0NKJYPiXGa9DTQR6f1VMOY7cco4uquNN5BRo4ucz1gu9w2Ff3N+1Hdz9V1r7xulkkd/78IyoJqHQDgp1eO3q6NZJT55DNsSuS2ZuYQc3yQUyTHH/G7gIF7EwRTU6dhRTGMYpfOQhRT67EVidHOT4e7GSpkWoGzi5XUBA+9N1llRCAwzRJ65lQqJZIC/vNgxJhHR5Cd4AOfHc+KuGlXMpCQkeYjd7a+ggh4RUuPsMW59QlKaBbZ1mbGHPzphFUrJIS63TMcJRrWbGwXHJrvZnD1NYNOM/x/qSR4pTkv8soIHFzgvFbRME5VTfxWfWKSCG/qu3TaWfetnYXmsqhdmnURekF4iSMtyDpVch+86zK5YmuO9Ap18MvdwmnfX5r9xhyPRga/QqmkdEI6ZebuXVYJQGr6Lzsz4z+4AGI0v87j//APsGxvi8fwAAAgA7w6N/pgZWFlB+p/Muirk+VQ==xxc>';
            const myContactFileName = 'theirE2eContact.xxc';
            const statePath = 'statePathSender';
            const statePass = 'password';

            document.getElementById('ndf-input')
                .addEventListener('change', function (e) {
                    let reader = new FileReader();
                    reader.onload = function (e) {
                        SendE2e(e.target.result, recipientContactFile, myContactFileName, statePath, statePass);
                    };
                    reader.readAsText(e.target.files[0]);
                }, false);
        });
	</script>
</head>
<body>
<h1>Sender</h1>
<form id="start-cmix">
	<div>
		<label for="ndf-input">Select NDF file to use <code>ndf</code> variable in JS:</label><br/>
		<input type="file" id="ndf-input" required/>
	</div>
<!--	<div>
		<label for="ndf-input">Recipient contact path:</label><br/>
		<input type="file" id="recipient-contact-input" required/>
	</div>
	<input type="submit" value="Start">-->
</form>
<div id="output" style="padding:10px;border:1px solid red"></div>
</body>

<script>
</script>
</html>